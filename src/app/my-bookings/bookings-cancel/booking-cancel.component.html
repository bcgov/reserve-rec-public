<div *ngIf="loading" class="text-center my-5">
  <div class="spinner-border" role="status"></div>
</div>
<div *ngIf="!loading">
  <div class="container mt-5 mb-3">
    <a routerLink="/account/bookings/{{ booking?.id }}" class="btn btn-link p-0">
      &lt; Back to My Bookings Details
    </a>
  </div>

  <div class="container mt-5" *ngIf="booking">
    <!-- Page Heading -->
    <div class="row">
      <div class="col text-left">
        <h1>Cancellation and Refund</h1>
      </div>
      <p><b>Booking number: </b>{{ booking.bookingId }}</p>
    </div>
  </div>

  <div class="container mt-5" *ngIf="booking">
    <div class="row mb-4">
      <div class="col-md-8">
        <div>
          <h4>Are you sure you want to <span class="text-danger">cancel</span> your booking for {{ booking.parkName }}?</h4>
          <p>Cancelling this booking may be subject to cancellation fees as per our cancellation policy.</p>
        </div>
        <div class="col bg-body-secondary border border-dark p-4">
          <div class="pt-4">
            <h4>{{booking?.parkName}}</h4>
            <div class="text-muted">
              {{booking.startDate | date: 'EEE, MMM d, yyyy'}} - {{booking.endDate | date: 'EEE, MMM d, yyyy'}}
            </div>
          </div>
          <div class="pt-4">
            <table class="w-100">
              <thead>
                <tr>
                  <th scope="col" class="text-small text-muted fw-normal">Line item</th>
                  <th scope="col" class="text-small text-muted fw-normal text-end">Tax included</th>
                  <th scope="col" class="text-small text-muted fw-normal text-end">Base cost</th>
                  <th scope="col" class="text-small text-muted fw-normal text-end">Quantity</th>
                  <th scope="col" class="text-small text-muted fw-normal text-end">Refund total</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <div class="mb-2">
                      Nightly camping fee
                    </div>
                    <div class="text-muted ms-3">
                      <div *ngIf="getAdultOccupants() > 0" class="mb-2">
                        {{getAdultOccupants()}} x Adult/Senior nightly rate ({{adultRate | currency: 'CAD' :
                        'symbol-narrow'}}/night)
                      </div>
                      <div *ngIf="getYouthOccupants() > 0" class="mb-2">
                        {{getYouthOccupants()}} x Youth nightly rate ({{youthRate | currency: 'CAD' :
                        'symbol-narrow'}}/night)
                      </div>
                    </div>
                  </td>
                  <td class="text-muted text-end">
                    <i class="fa-solid fa-check"></i>
                  </td>
                  <td class="text-end">
                    {{getNightlyAdultCost() + getNightlyYouthCost() | currency: 'CAD' : 'symbol-narrow'}}
                  </td>
                  <td class="text-end">
                    {{calculateTotalNights()}}
                  </td>
                  <td class="text-end">
                    {{getTotalCost() | currency: 'CAD' : 'symbol-narrow'}}
                  </td>
                </tr>
              </tbody>
              <tfoot class="table-group-divider border-gray">
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="text-small text-end">
                    <div class="mt-3 mb-1">
                      Subtotal
                    </div>
                  </td>
                  <td class="text-small text-end">{{getTotalCost() | currency: 'CAD' : 'symbol-narrow'}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="text-small text-end">
                    <div class="mb-1">
                      GST
                    </div>
                  <td class="text-small text-end">n/a</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="text-secondary fw-bold text-end">
                    <div class="mb-1">
                      Refund total
                    </div>
                  </td>
                  <td class="text-secondary fw-bold text-end">+{{getTotalCost() | currency: 'CAD' : 'symbol-narrow'}}
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td class="text-small text-end">
                    <div class="mb-1">
                      <em>(Inclusive GST)</em>
                    </div>
                  </td>
                  <td class="text-small text-end"><em>({{calculateInclusiveGST() | currency: 'CAD' :
                      'symbol-narrow'}})</em></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
      <div class="mt-4">
        <button class="btn btn-danger rounded-0 me-3" (click)="onConfirmRefund()">Yes, Cancel Booking</button>
        <a routerLink="/account/bookings/{{ booking.bookingId }}" class="btn btn-secondary rounded-0">No, Go Back</a>
      </div>
    </div>
  </div>
</div>
